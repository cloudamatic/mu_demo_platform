---
appname: demo
loadbalancers:
- name: gitlab-lb
  classic: true
  vpc:
    vpc_id: vpc-040da43493f894a8d
    subnets:
    - subnet_name: ryan_public
  healthcheck:
    target: HTTP:80/users/sign_in
    timeout: 2
    interval: 5
    unhealthy-threshold: 2
    healthy-threshold: 2
  listeners:
  - lb-port: 22
    lb-protocol: TCP
    instance-port: 22
    instance-protocol: TCP
  - lb-port: 443
    lb-protocol: HTTPS
    instance-port: 80
    instance-protocol: HTTP
    ssl-certificate-name: "*.egt-labs.com"
  ingress_rules:
  - port: 443
    hosts:
    - 0.0.0.0/0
  - port: 22
    hosts:
    - 0.0.0.0/0
servers:
  -
    name: gitlab-server
    platform: centos7
    storage:
      -
        size: 30
    skipinitialupdates: true
    loadbalancers:
    - concurrent-load-balancer: gitlab-lb
    size: t2.large
    run_list:
    - recipe[demo_gitlab]
    - recipe[demo_gitlab::gitlab_runner]
    vpc:
      vpc_id: vpc-040da43493f894a8d
      subnets:
      - subnet_name: ryan_private
    ingress_rules:
      -
        port: 80
        hosts:          
          - "0.0.0.0/0"
                                                                         